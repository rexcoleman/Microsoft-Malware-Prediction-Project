import pandas as pd
from src.data.clean_data import handle_missing_values, remove_duplicates

def test_handle_missing_values():
    df = pd.DataFrame({'A': [1, None, 3]})
    df = handle_missing_values(df)
    assert df.isnull().sum().sum() == 0, "There should be no missing values"

def test_remove_duplicates():
    df = pd.DataFrame({'id': [1, 1, 2], 'value': [10, 10, 20]})
    df = remove_duplicates(df, 'id')
    assert len(df) == 2, "There should be 2 unique rows after removing duplicates"

if __name__ == "__main__":
    test_handle_missing_values()
    test_remove_duplicates()
    print("All tests passed!")
